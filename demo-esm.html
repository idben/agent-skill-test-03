<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dialog Replace Demo - Bootstrap æ¨£å¼</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
  <style>
    /* Dialog åŸºç¤æ¨£å¼ */
    dialog {
      border: none;
      border-radius: 0.5rem;
      padding: 0;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    }

    dialog::backdrop {
      background: rgba(0, 0, 0, 0.5);
      animation: backdropFadeIn 0.3s ease;
    }

    /* å‹•ç•«è¨­å®š */
    dialog {
      --animate-duration: 0.3s;
    }

    dialog.dialog-closing::backdrop {
      animation: backdropFadeOut 0.3s ease forwards;
    }

    @keyframes backdropFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes backdropFadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }

    dialog .dialog-header {
      display: flex;
      align-items: center;
      padding: 1rem 1rem 0.5rem;
      gap: 0.75rem;
    }

    dialog .dialog-header .dialog-icon {
      font-size: 1.5rem;
      line-height: 1;
    }

    dialog .dialog-header .dialog-title {
      margin: 0;
      font-size: 1.125rem;
      font-weight: 600;
    }

    dialog .dialog-body {
      padding: 0.5rem 1rem 1rem;
    }

    dialog .dialog-footer {
      display: flex;
      gap: 0.5rem;
      justify-content: flex-end;
      padding: 0.75rem 1rem;
      background: #f8f9fa;
      border-top: 1px solid #dee2e6;
      border-radius: 0 0 0.5rem 0.5rem;
    }

    /* Alert é¡å‹æ¨£å¼ */
    dialog.alert-success .dialog-header { color: #198754; }
    dialog.alert-error .dialog-header { color: #dc3545; }
    dialog.alert-info .dialog-header { color: #0d6efd; }

    /* Prompt éŒ¯èª¤æç¤º */
    dialog .error-message {
      color: #dc3545;
      font-size: 0.875rem;
      margin-top: 0.25rem;
      display: none;
    }

    dialog .error-message.show {
      display: block;
    }

    /* Dialog æ¸…å–®æ¨£å¼ */
    dialog .list-group-item {
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    dialog .list-group-item:hover {
      background-color: #e9ecef;
    }

    dialog .list-group-item .list-icon {
      font-size: 1.25rem;
    }

    /* çµæœé¡¯ç¤ºå€ */
    .result-display {
      background: #f8f9fa;
      border-radius: 0.375rem;
      padding: 0.75rem 1rem;
      font-family: monospace;
      font-size: 0.875rem;
      min-height: 2.5rem;
    }
  </style>
</head>
<body class="bg-light">
  <div class="container py-5">
    <header class="text-center mb-5">
      <h1 class="display-5 fw-bold">Dialog Replace Demo</h1>
      <p class="lead text-muted">ä½¿ç”¨åŸç”Ÿ HTML <code>&lt;dialog&gt;</code> å–ä»£å‚³çµ± JavaScript å°è©±æ¡†</p>
    </header>

    <div class="row g-4">
      <!-- Alert å€å¡Š -->
      <div class="col-md-6">
        <div class="card h-100">
          <div class="card-header">
            <h5 class="card-title mb-0">Alert è¨Šæ¯æç¤º</h5>
          </div>
          <div class="card-body">
            <p class="text-muted small">å–ä»£ <code>window.alert()</code>ï¼Œæ”¯æ´ä¸‰ç¨®è¨Šæ¯é¡å‹</p>
            <div class="d-flex flex-wrap gap-2">
              <button type="button" class="btn btn-success" id="btnAlertSuccess">
                æˆåŠŸè¨Šæ¯
              </button>
              <button type="button" class="btn btn-danger" id="btnAlertError">
                éŒ¯èª¤è¨Šæ¯
              </button>
              <button type="button" class="btn btn-primary" id="btnAlertInfo">
                ä¸€èˆ¬é€šçŸ¥
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Confirm å€å¡Š -->
      <div class="col-md-6">
        <div class="card h-100">
          <div class="card-header">
            <h5 class="card-title mb-0">Confirm ç¢ºèªå°è©±æ¡†</h5>
          </div>
          <div class="card-body">
            <p class="text-muted small">å–ä»£ <code>window.confirm()</code>ï¼Œæ”¯æ´è‡ªå®šç¾©æŒ‰éˆ•</p>
            <div class="d-flex flex-wrap gap-2">
              <button type="button" class="btn btn-outline-danger" id="btnConfirmDelete">
                åˆªé™¤ç¢ºèª
              </button>
              <button type="button" class="btn btn-outline-warning" id="btnConfirmLeave">
                é›¢é–‹ç¢ºèª
              </button>
              <button type="button" class="btn btn-outline-secondary" id="btnConfirmCustom">
                è‡ªå®šç¾©æŒ‰éˆ•
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Prompt å€å¡Š -->
      <div class="col-md-6">
        <div class="card h-100">
          <div class="card-header">
            <h5 class="card-title mb-0">Prompt è¼¸å…¥å°è©±æ¡†</h5>
          </div>
          <div class="card-body">
            <p class="text-muted small">å–ä»£ <code>window.prompt()</code>ï¼Œæ”¯æ´é©—è­‰è¼¸å…¥</p>
            <div class="d-flex flex-wrap gap-2">
              <button type="button" class="btn btn-outline-primary" id="btnPromptSimple">
                ç°¡å–®è¼¸å…¥
              </button>
              <button type="button" class="btn btn-outline-primary" id="btnPromptDefault">
                é è¨­å€¼è¼¸å…¥
              </button>
              <button type="button" class="btn btn-outline-primary" id="btnPromptValidate">
                é©—è­‰è¼¸å…¥
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Dialog å€å¡Š -->
      <div class="col-md-6">
        <div class="card h-100">
          <div class="card-header">
            <h5 class="card-title mb-0">Dialog è‡ªå®šç¾©å°è©±æ¡†</h5>
          </div>
          <div class="card-body">
            <p class="text-muted small">é€²éšè‡ªå®šç¾©å°è©±æ¡†ï¼Œæ”¯æ´å¤šæŒ‰éˆ•èˆ‡è¤‡é›œå…§å®¹</p>
            <div class="d-flex flex-wrap gap-2">
              <button type="button" class="btn btn-outline-dark" id="btnDialogButtons">
                å¤šæŒ‰éˆ•é¸æ“‡
              </button>
              <button type="button" class="btn btn-outline-dark" id="btnDialogHtml">
                HTML å…§å®¹
              </button>
              <button type="button" class="btn btn-outline-dark" id="btnDialogList">
                æ¸…å–®é¸é …
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer class="text-center mt-5 text-muted">
      <small>Dialog Replace Skill - ä½¿ç”¨ Bootstrap 5.3 æ¨£å¼</small>
    </footer>
  </div>

  <!-- Alert Dialog -->
  <dialog id="alertDialog">
    <div class="dialog-header">
      <span class="dialog-icon"></span>
      <h6 class="dialog-title">æç¤º</h6>
    </div>
    <div class="dialog-body">
      <p class="message mb-0"></p>
    </div>
    <div class="dialog-footer">
      <button type="button" class="btn btn-primary" autofocus>ç¢ºå®š</button>
    </div>
  </dialog>

  <!-- Confirm Dialog -->
  <dialog id="confirmDialog">
    <div class="dialog-header">
      <span class="dialog-icon">âš ï¸</span>
      <h6 class="dialog-title">ç¢ºèª</h6>
    </div>
    <div class="dialog-body">
      <p class="message mb-0"></p>
    </div>
    <div class="dialog-footer">
      <button type="button" class="btn btn-secondary btn-cancel">å–æ¶ˆ</button>
      <button type="button" class="btn btn-primary btn-confirm" autofocus>ç¢ºå®š</button>
    </div>
  </dialog>

  <!-- Prompt Dialog -->
  <dialog id="promptDialog">
    <form method="dialog">
      <div class="dialog-header">
        <span class="dialog-icon">âœï¸</span>
        <h6 class="dialog-title">è¼¸å…¥</h6>
      </div>
      <div class="dialog-body">
        <label class="form-label message"></label>
        <input type="text" class="form-control" name="input" autofocus>
        <div class="error-message"></div>
      </div>
      <div class="dialog-footer">
        <button type="button" class="btn btn-secondary btn-cancel">å–æ¶ˆ</button>
        <button type="submit" class="btn btn-primary btn-confirm">ç¢ºå®š</button>
      </div>
    </form>
  </dialog>

  <!-- Custom Dialog -->
  <dialog id="customDialog">
    <div class="dialog-header">
      <span class="dialog-icon"></span>
      <h6 class="dialog-title"></h6>
    </div>
    <div class="dialog-body">
      <div class="dialog-content"></div>
    </div>
    <div class="dialog-footer"></div>
  </dialog>

  <script type="module">
    import {
      init,
      showAlert,
      showConfirm,
      showPrompt,
      showDialog
    } from './dialog-api.js';

    // Bootstrap é©é…å™¨
    const bootstrapAdapter = {
      createButton: (text, style = 'secondary') => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.textContent = text;
        btn.className = `btn btn-${style}`;
        return btn;
      },
      setButtonStyle: (btn, style) => {
        btn.className = btn.className.replace(/btn-\w+/g, '').trim();
        btn.classList.add('btn', `btn-${style}`);
      },
      getInputValue: (input) => input.value,
      setInputValue: (input, value) => { input.value = value; },
      setInputPlaceholder: (input, placeholder) => { input.placeholder = placeholder; },
      setInputLabel: (label, text) => { label.textContent = text; },
      focusInput: (input) => {
        input.focus();
        if (input.select) input.select();
      }
    };

    // åˆå§‹åŒ– DialogAPI
    init({
      dialogs: {
        alert: document.querySelector('#alertDialog'),
        confirm: document.querySelector('#confirmDialog'),
        prompt: document.querySelector('#promptDialog'),
        custom: document.querySelector('#customDialog')
      },
      adapter: bootstrapAdapter
    });

    // ============================================
    // ç¤ºç¯„æŒ‰éˆ•äº‹ä»¶
    // ============================================

    // Alert ç¤ºç¯„
    document.querySelector('#btnAlertSuccess').addEventListener('click', async () => {
      await showAlert('æ“ä½œå·²æˆåŠŸå®Œæˆï¼', 'success');
    });

    document.querySelector('#btnAlertError').addEventListener('click', async () => {
      await showAlert('ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚', 'error');
    });

    document.querySelector('#btnAlertInfo').addEventListener('click', async () => {
      await showAlert('é€™æ˜¯ä¸€å‰‡ç³»çµ±é€šçŸ¥è¨Šæ¯ã€‚', 'info');
    });

    // Confirm ç¤ºç¯„
    document.querySelector('#btnConfirmDelete').addEventListener('click', async () => {
      const result = await showConfirm('ç¢ºå®šè¦åˆªé™¤é€™ç­†è³‡æ–™å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚', {
        type: 'danger',
        confirmText: 'åˆªé™¤',
        cancelText: 'å–æ¶ˆ'
      });

      if (result) {
        await showAlert('è³‡æ–™å·²æˆåŠŸåˆªé™¤', 'success');
      } else {
        await showAlert('å·²å–æ¶ˆåˆªé™¤æ“ä½œ', 'info');
      }
    });

    document.querySelector('#btnConfirmLeave').addEventListener('click', async () => {
      const result = await showConfirm('æ‚¨æœ‰æœªå„²å­˜çš„è®Šæ›´ï¼Œç¢ºå®šè¦é›¢é–‹å—ï¼Ÿ', {
        confirmText: 'é›¢é–‹',
        cancelText: 'ç•™ä¸‹'
      });

      if (result) {
        await showAlert('æ‚¨å·²é¸æ“‡é›¢é–‹', 'info');
      } else {
        await showAlert('æ‚¨é¸æ“‡ç•™ä¸‹ç¹¼çºŒç·¨è¼¯', 'success');
      }
    });

    document.querySelector('#btnConfirmCustom').addEventListener('click', async () => {
      const result = await showConfirm('è¦ä½¿ç”¨æ·±è‰²æ¨¡å¼é‚„æ˜¯æ·ºè‰²æ¨¡å¼ï¼Ÿ', {
        confirmText: 'æ·±è‰²æ¨¡å¼',
        cancelText: 'æ·ºè‰²æ¨¡å¼'
      });

      if (result) {
        await showAlert('å·²åˆ‡æ›è‡³æ·±è‰²æ¨¡å¼', 'success');
      } else {
        await showAlert('å·²åˆ‡æ›è‡³æ·ºè‰²æ¨¡å¼', 'success');
      }
    });

    // Prompt ç¤ºç¯„
    document.querySelector('#btnPromptSimple').addEventListener('click', async () => {
      const name = await showPrompt('è«‹è¼¸å…¥æ‚¨çš„åå­—ï¼š');

      if (name) {
        await showAlert(`æ­¡è¿ï¼Œ${name}ï¼`, 'success');
      } else {
        await showAlert('æ‚¨å·²å–æ¶ˆè¼¸å…¥', 'info');
      }
    });

    document.querySelector('#btnPromptDefault').addEventListener('click', async () => {
      const nickname = await showPrompt('è«‹è¼¸å…¥æš±ç¨±ï¼š', {
        defaultValue: 'åŒ¿åä½¿ç”¨è€…'
      });

      if (nickname) {
        await showAlert(`æ‚¨çš„æš±ç¨±å·²è¨­å®šç‚ºï¼š${nickname}`, 'success');
      } else {
        await showAlert('æ‚¨å·²å–æ¶ˆè¨­å®šæš±ç¨±', 'info');
      }
    });

    document.querySelector('#btnPromptValidate').addEventListener('click', async () => {
      const email = await showPrompt('è«‹è¼¸å…¥ Emailï¼š', {
        placeholder: 'example@mail.com',
        validate: (value) => {
          if (!value) return 'è«‹è¼¸å…¥ Email';
          if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value)) {
            return 'Email æ ¼å¼ä¸æ­£ç¢º';
          }
          return null;
        }
      });

      if (email) {
        await showAlert(`Email å·²è¨­å®šï¼š${email}`, 'success');
      } else {
        await showAlert('æ‚¨å·²å–æ¶ˆè¼¸å…¥ Email', 'info');
      }
    });

    // Dialog ç¤ºç¯„
    document.querySelector('#btnDialogButtons').addEventListener('click', async () => {
      const action = await showDialog('è«‹é¸æ“‡æª”æ¡ˆè™•ç†æ–¹å¼ï¼š', {
        title: 'æª”æ¡ˆæ“ä½œ',
        icon: 'ğŸ“',
        buttons: [
          { text: 'ä¸‹è¼‰', value: 'download', style: 'primary' },
          { text: 'åˆ†äº«', value: 'share', style: 'secondary' },
          { text: 'åˆªé™¤', value: 'delete', style: 'danger' },
          { text: 'å–æ¶ˆ', value: 'cancel', style: 'light' }
        ]
      });

      const actionText = {
        download: 'ä¸‹è¼‰æª”æ¡ˆ',
        share: 'åˆ†äº«æª”æ¡ˆ',
        delete: 'åˆªé™¤æª”æ¡ˆ',
        cancel: 'å–æ¶ˆæ“ä½œ'
      };

      await showAlert(`æ‚¨é¸æ“‡äº†ï¼š${actionText[action] || action}`, 'info');
    });

    document.querySelector('#btnDialogHtml').addEventListener('click', async () => {
      const result = await showDialog({
        title: 'ç”¢å“ä»‹ç´¹',
        icon: 'ğŸ§',
        html: `
          <div class="text-center mb-3">
            <div class="bg-light rounded p-4 mb-3">
              <span style="font-size: 4rem;">ğŸ§</span>
            </div>
            <h5 class="mb-1">ç„¡ç·šè—ç‰™è€³æ©Ÿ Pro</h5>
            <p class="text-muted small mb-2">é«˜å“è³ªéŸ³æ•ˆï¼Œä¸»å‹•é™å™ªï¼ŒçºŒèˆª 24 å°æ™‚</p>
            <div class="d-flex justify-content-center gap-2 mb-2">
              <span class="badge bg-success">ç†±éŠ·</span>
              <span class="badge bg-warning text-dark">é™æ™‚å„ªæƒ </span>
            </div>
            <p class="h4 text-primary mb-0">NT$ 1,299</p>
            <small class="text-muted text-decoration-line-through">NT$ 1,999</small>
          </div>
        `,
        buttons: [
          { text: 'åŠ å…¥è³¼ç‰©è»Š', value: 'cart', style: 'primary' },
          { text: 'é—œé–‰', value: 'close', style: 'secondary' }
        ]
      });

      if (result === 'cart') {
        await showAlert('å·²åŠ å…¥è³¼ç‰©è»Šï¼', 'success');
      }
    });

    document.querySelector('#btnDialogList').addEventListener('click', async () => {
      const lang = await showDialog('è«‹é¸æ“‡èªè¨€ï¼š', {
        title: 'åˆ‡æ›èªè¨€',
        icon: 'ğŸŒ',
        type: 'list',
        options: [
          { text: 'ç¹é«”ä¸­æ–‡', value: 'zh-TW', icon: 'ğŸ‡¹ğŸ‡¼' },
          { text: 'English', value: 'en', icon: 'ğŸ‡ºğŸ‡¸' },
          { text: 'æ—¥æœ¬èª', value: 'ja', icon: 'ğŸ‡¯ğŸ‡µ' },
          { text: 'í•œêµ­ì–´', value: 'ko', icon: 'ğŸ‡°ğŸ‡·' }
        ]
      });

      if (lang) {
        const langNames = {
          'zh-TW': 'ç¹é«”ä¸­æ–‡',
          'en': 'English',
          'ja': 'æ—¥æœ¬èª',
          'ko': 'í•œêµ­ì–´'
        };
        await showAlert(`å·²åˆ‡æ›è‡³ï¼š${langNames[lang]}`, 'success');
      } else {
        await showAlert('å·²å–æ¶ˆåˆ‡æ›èªè¨€', 'info');
      }
    });

      </script>
</body>
</html>
